#6장 상속을 이용해 새로운 행동얻기

## 6.1 고전적 상속 이해하기
- 상속이란 자동화된 메시지 전달 시스템이다(automatic message delegation)
- 특정 객체가 이해할 수 없는 메시지를 전달받았을 경우 그 객체는 이 메시지를 다른 객체에게 전달한다.
- 명시적으로 메시지를 위임(delegate)하는 코드를 작성하지 않아도 두 객체 사이의 상속 관계를 정의하면 자동으로 메시지 전달(하위 클래스 -> 상위클래스)이 이루어 진다

## 6.2 상속을 사용해야 하는 지점을 알기

### 6.2.1 구체 클래스에서 시작하기
- 자전거는 전반적인 크기, 체인, 타이어 크기는 이미 구현되어 있다
- 로드 자전거에는 핸들바 테이프가, 마운틴 자전거에는 서스펜션이 필요하다는 점만 다를뿐이다.

### 6.2.2 자전거 종류 추가하기
- 자기가 어떤 종류인지 알고 있는 어트리뷰트를 확인하는 if문을 포함하는 안티패턴이 있다.
- 오리타입에서 언급했던 객체의 클래스를 확인하고 객체에게 어떤 메시지를 전송할지 결정하는 안티패턴이 있다.
- 객체의 클래스를 자기가 어떤 종류인지 알고 있는 어트리뷰트는 다음과 같이 말할 것이다. "나는 네가 누구인지 알고있다. 때문에 네가 무엇을 하는지도 안다." 이 지식은 수정비용을 높이는 의존성이다

### 6.2.3 숨겨진 타입 찾아내기
- 하나의 클래스가 여러 개의 서로 다른, 하지만 연관된 타입을 가지고 있으면 상속을 통해 해결할 수 있는 문제이다.
- 밀접히 연관된 타입들이 같은 행동을 공유하고 있지만 특정한 관점에서는 다른 경우인 것이다.

### 6.2.4 상속을 선택하기
- 객체는 메시지를 직접 처리하거나 다른 객체가 처리할 수 있도록 메시지를 넘기면서 메시지를 처리한다.
- 상속은 두 객체 사이의 관계를 정의한다. 첫 번째 객체가 이해할 수 없는 메시지를 수신하면 이 객체는 다음 객체에게 자동으로 메시지를 전달한다
- 다중상속을 지원할 경우 메시지를 전달해야할 부모를 선택해야하는 문제가 생긴다.(둘 이상의 부모가 같은 메시지에 대한 처리를 구현하고 있다면 어느 부모에게 우선권이 있는가?)
- 여러 객체지향 언어들은 이런 복잡함을 피해가기 위해 단일상속을 지원한다

## 6.3 상속의 잘못된 사용
- 하위클래스는 상위클래스의 특수한 형태이다.
- Bicycle과 협업할 수 있는 모든 객체는 MountainBike에 대해 아무것도 모른 채 MountainBike와 협업할 수 있어야 한다. 
- 상속이 제대로 작동하기 위해 충족되어야할 조건
    - 모델링하는 객체들이 명백하게 일반-특수 관계를 따라야한다
    - 올바른 코딩기술을 사용해야 한다
    
### 6.4.1 추상화된 상위클래스 만들기
- 어떤 객체지향 프로그래밍 언어는 특정 클래스를 명시적으로 추상 클래스로 선언할 수 있도록 해준다 // new 메시지를 전송할 수 없다
- 추상 클래스는 상속받기 위해서 존재한다. 하위클래스들이 공유하는 공통된 행동들의 저장소이고 상속받은 하위클래스들은 구체적인 형태를 제공할 수 있다.
- 상속 관계를 만드는 데는 높은 비용이 든다.
- 상속 관계를 만들지 말지를 선택하는 것은 '세 번째 종류의 자전거가 얼마나 빨리 필요하게 될지', '중복 코드를 관리하는 비용이 얼마인지' 사이에 달려있다.
- 곧 세번째 종류를 구현해야 할 것 같다면 더 나은 정보를 얻을 때까지 기다리는 것이 낫다. 반면, 중복 코드를 매일 변경해야 한다면 상속 관계를 만드는 것이 보다 나은 선택일 수 있다.

### 6.4.2 추상적인 행동을 위로 올리기
- 상속을 구현하는데 따르는 여러 어려움은 구체적인 것과 추상적인 것을 제대로 구분하지 못하는 데서 기인한다.
- '위로 올리기' 전략은 실패했더라도 수정하기 쉬운 문제를 발생시킨다.
- 추상 클래스에 구체적인 행동이 남아 있다면 새로운 하위클래스레에 적용될 수 있는 행동이 아니라면 이 상속 관계는 믿을 수 있는 것이 아니다.

### 6.4.3 구체적인 것들 속에서 추상적인 것 분리해내기

### 6.4.4 템플릿 메서드 패턴 사용하기
- 궁극적인 목표는 하위클래스가 이 메서드를 재정의하는 것을 통해 하위클래스만의 특수한 행동을 추가할 수 있도록 하기 위함이다
- 기본 구조를 상위클래스가 정의하고 상위클래스에서 메시지를 전송하여 하위클래스의 특수한 값을 덮는 기술을 템플릿 메서드(template method) 패턴이라고 부른다

### 6.4.5 모든 템플릿 메서드 구현하기
- 템플릿 메서드 패턴을 사용할 때는 언제나 호출되는 메서드를 작성하고 유용한 에러 메시지를 제공해야 한다.

## 6.5 상위클래스와 하위 클래스 사이의 커플링 관리하기

### 6.5.2 커플링 이해하기
- 다른 클래스에 대해 알고 있다면 여기서 의존성이 만들어진다. 하위클래스가 super를 전송하면서 의존성이 만들어진다.
- 하위 클래스에서 super를 전송하지 않았을 경우에 치명적인 문제가 발생한다.
- 하위클래스는 상위클래스와 어떻게 소통해야 하는지 알고 있어야한다. 하지만 상위클래스와 어떻게 소통해야 하는지도 알아야할 때, 문제가 발생한다.
- 하위클래스가 super를 전송한다는 것은 스스로 알고리즘에 대해 알고 있다고 말하는 것이며, 이 지식에 의존하고 있는 것이다.

### 6.5.2 훅 메시지를 사용해서 하위클래스의 결합 없애기
- 하위클래스가 알고리즘을 알고 있고 super를 전송하는 대신 훅(hook) 메시지를 전송할 수 있다.
- 훅 메시지는 정해진 메서드 구현을 통해 하위클래스가 정보를 제공할 수 있도록 만들어주는 메시지이다. 이 방법을 사용하면 하위클래스는 알고리즘에 대해 몰라도 되며, 상위클래스가 모든 권한을 가질 수 있게 된다.

## 6.6 요약
- 공통된 코드를 고립시키고 공통의 알고리즘을 추상 클래스가 구현할 수 있도록 해준다. 동시에 하위 클래스가 특수한 생동을 추가할 수 있는 여지도 남겨 놓는다
- 추상화된 상위클래스를 만드는 가장 좋은 방법은 구체적인 하위클래스의 코드를 위로 올리는 것이다.
- 추상화된 상위클래스는 템플릿 메서드 패턴을 이용해서 하위클래스가 자신의 특수한 내용을 추가할 수 있도록 돕는다.
- 훅 메서드를 이용해 하위클래스가 추상화 알고리즘을 알지 못해도 자신의 특수한 내용을 추가할 수 있다. 하위클래스가 super를 전송하지 않아도 괜찮기 때문에 결합이 느슨해진다.
